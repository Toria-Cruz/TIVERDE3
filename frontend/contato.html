<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Contato - EcoTech Energy Solutions</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="Css/style.css">
</head>

<body>

    <!-- ======================== NAVBAR ======================== -->
    <nav id="header-nav" class="navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm py-3">
        <div class="container-fluid px-lg-5">

            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <img src="img/ecotech-fundo.png" alt="Logo EcoTech" class="img-fluid me-2 logo-brand">
            </a>

            <button class="navbar-toggler border-0 shadow-none" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                aria-label="Alternar navega√ß√£o">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">

                <ul id="pages-nav" class="navbar-nav mx-auto mb-2 mb-lg-0 d-flex flex-row gap-3">
                    <li class="nav-item">
                        <a class="nav-link px-3 fw-semibold custom-link" href="sobre.html">Sobre</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link px-3 fw-semibold custom-link" href="#services">Servi√ßos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link px-3 fw-semibold custom-link active" href="contato.html">Contato</a>
                    </li>
                </ul>

                <div class="d-flex align-items-center gap-2">
                    <a id="login-botao" href="#" 
                        class="btn btn-outline-success rounded-pill px-4 fw-medium transition-btn">Entrar</a>

                    <div class="dropdown d-none" id="perfil-dropdown">
                        <button class="btn btn-success dropdown-toggle btn-sm d-flex align-items-center gap-2"
                            type="button" id="perfil-botao" data-bs-toggle="dropdown">
                            <img id="userAvatar" src="img/user.png" class="avatar-sm rounded-circle">
                            <span id="usernameLabel">Usu√°rio</span>
                        </button>

                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="page-graf.html">Dashboard</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" id="logout-btn">Sair</a></li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </nav>


    <!-- ======================== HEADER CONTATO ======================== -->
    <header class="hero-section">
        <div class="hero-wrapper container">
            <div class="hero-box d-flex flex-column align-items-center text-center gap-3">

                <img src="img/ecotech-fundo.png" alt="Logo" class="hero-img" style="max-width: 150px;">

                <h1 class="display-4 fw-bold">Fale Conosco</h1>
                <p class="lead">Entre em contato com nossa equipe especializada.</p>
            </div>
        </div>
    </header>


    <!-- ======================== FORMUL√ÅRIO DE CONTATO ======================== -->
    <main class="main-content-wrapper">
        <div class="container py-5">

            <div class="row g-4">

                <!-- ======= FORM ======= -->
                <div class="col-lg-7">
                    <div class="card custom-card p-4 shadow-sm">

                        <h2 class="fw-bold mb-3">Envie sua mensagem</h2>
                        <p class="text-muted mb-4">
                            Retornaremos o mais breve poss√≠vel.
                        </p>

                        <form id="form-contato">

                            <div class="mb-3">
                                <label class="form-label fw-medium">Nome</label>
                                <input type="text" class="form-control" placeholder="Seu nome" required>
                            </div>

                            <div class="mb-3">
                                <label class="form-label fw-medium">E-mail</label>
                                <input type="email" class="form-control" placeholder="Seu e-mail" required>
                            </div>

                            <div class="mb-3">
                                <label class="form-label fw-medium">Telefone</label>
                                <input type="text" class="form-control" placeholder="(00) 00000-0000">
                            </div>

                            <div class="mb-3">
                                <label class="form-label fw-medium">Mensagem</label>
                                <textarea class="form-control" rows="5" placeholder="Digite sua mensagem..."
                                    required></textarea>
                            </div>

                            <button type="submit" class="btn btn-success px-4">Enviar</button>

                        </form>

                    </div>
                </div>

                <!-- ======= INFORMA√á√ïES ======= -->
                <div class="col-lg-5">
                    <div class="card custom-card p-4 shadow-sm">

                        <h2 class="fw-bold mb-3">Informa√ß√µes de Contato</h2>

                        <p class="text-muted">
                            Entre em contato com nossas unidades ou envie um e-mail:
                        </p>

                        <h4 class="fw-semibold mt-3">üìç Matriz ‚Äì Manaus/AM</h4>
                        <p class="text-muted mb-3">
                            Rua Exemplo, 123 ‚Äì Centro  
                            <br> CEP: 95900-000  
                            <br> Telefone: (51) 99999-9999
                        </p>

                        <h4 class="fw-semibold">üìç Unidade ‚Äì Rio de Janeiro/RJ</h4>
                        <p class="text-muted mb-3">
                            Avenida Exemplo, 456 ‚Äì Copacabana  
                            <br> CEP: 22000-000  
                            <br> Telefone: (21) 98888-8888
                        </p>

                        <h4 class="fw-semibold">üìß E-mail</h4>
                        <p class="text-muted mb-3">
                            atendimento@ecotech.com.br
                        </p>

                        <h4 class="fw-semibold">üïí Hor√°rio de Atendimento</h4>
                        <p class="text-muted">
                            Segunda a Sexta: 08h ‚Äì 18h  
                            <br> S√°bado: 08h ‚Äì 12h
                        </p>

                    </div>
                </div>

            </div>

        </div>
    </main>


    <!-- ======================== FOOTER ======================== -->
    <footer class="bg-white py-4 border-top">
        <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center text-muted small">

            <div class="d-flex flex-column flex-md-row align-items-center mb-2 mb-md-0">
                <span class="me-md-3">2025 EcoTech Energy Solutions</span>
                <a href="#" class="text-muted text-decoration-none me-md-3">Privacy Policy</a>
                <a href="#" class="text-muted text-decoration-none">Terms of Service</a>
            </div>

            <span class="mb-2 mb-md-0">&copy; Todos os direitos reservados.</span>

            <div class="d-flex gap-3">
                <a href="#" class="text-muted text-decoration-none">f</a>
                <a href="#" class="text-muted text-decoration-none">t</a>
                <a href="#" class="text-muted text-decoration-none">in</a>
            </div>

        </div>
    </footer>

    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.getElementById("login-botao").addEventListener("click", function () {
            window.location.href = "page-graf.html";
        });
    </script>

    <button class="chat-button" onclick="toggleChat()">
        <img src="img/atendente.png" alt="Atendente" class="chat-icon">
    </button>

    <!-- Caixa do chatbot -->
    <div class="chatbox" id="chatbox">
        <div class="chat-header">
            Atendimento Online <span class="status-dot"></span>
        </div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
            <input type="text" id="userInput" placeholder="Digite sua mensagem..."
                onkeypress="if(event.key==='Enter'){sendMessage();}">
            <button onclick="sendMessage()">Enviar</button>
        </div>
    </div>

    <script>
        const BACKEND_URL = "http://localhost:5000/chat"; // URL do backend
        function toggleChat() {
            const chatbox = document.getElementById("chatbox");
            chatbox.style.display = chatbox.style.display === "flex" ? "none" : "flex";
            chatbox.style.flexDirection = "column";

        }

        async function sendMessage() {
            const input = document.getElementById("userInput");
            const msg = input.value.trim();
            if (!msg) return;
            addMessage(msg, "user");
            input.value = "";

            try {
                const response = await fetch(BACKEND_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ message: msg })

                });

                if (!response.ok) {
                    throw new Error(`Servidor retornou ${response.status}`);

                }
                const data = await response.json();
                addMessage(data.reply || "Sem resposta do servidor.", "bot");
            } catch (error) {
                console.error("Erro ao enviar mensagem:", error);
                addMessage("Ops! N√£o consegui me conectar ao servidor.", "bot");
            }
        }
        function addMessage(text, sender) {
            const chat = document.getElementById("chatMessages");
            const msgDiv = document.createElement("div");
            msgDiv.classList.add("message", sender);
            msgDiv.innerText = text;
            chat.appendChild(msgDiv);
            chat.scrollTop = chat.scrollHeight;
        }

        /* =========================
   Sistema de Login Corrigido
   ========================= */

        document.addEventListener("DOMContentLoaded", function () {
            const loginBtn = document.getElementById("login-botao");
            const perfilDropdown = document.getElementById("perfil-dropdown");
            const perfilBotao = document.getElementById("perfil-botao");
            const logoutBtn = document.getElementById("logout-btn");

            function atualizarEstadoLogin() {
                try {
                    const usuarioLogado = JSON.parse(sessionStorage.getItem("usuarioLogado"));

                    if (usuarioLogado && usuarioLogado.username) {
                        // Usu√°rio logado ‚Üí mostra dropdown
                        loginBtn.classList.add("d-none");
                        perfilDropdown.classList.remove("d-none");

                        // Atualiza nome no bot√£o
                        perfilBotao.textContent = usuarioLogado.username;

                    } else {
                        // Usu√°rio N√ÉO logado ‚Üí mostra bot√£o login
                        loginBtn.classList.remove("d-none");
                        perfilDropdown.classList.add("d-none");
                    }
                } catch (err) {
                    sessionStorage.removeItem("usuarioLogado");
                }
            }

            loginBtn.addEventListener("click", function (e) {
                e.preventDefault();
                window.location.href = "public/login.html";
            });

            logoutBtn.addEventListener("click", function (e) {
                e.preventDefault();
                sessionStorage.removeItem("usuarioLogado");
                window.location.href = "index.html";
            });

            atualizarEstadoLogin();
            window.addEventListener("pageshow", atualizarEstadoLogin);
        });

    </script>
</body>

</html>